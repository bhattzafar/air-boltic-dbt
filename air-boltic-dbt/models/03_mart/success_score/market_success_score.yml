version: 2

models:
  - name: market_level_success_score
    description: "{{ doc('market_level_success_score') }}"
    columns:
      - name: destination_city
        description: "{{ doc('destination_city') }}"
        tests:
          - not_null:
              severity: warn
          - unique:
              severity: warn

      - name: norm_utilization
        description: "{{ doc('normalized_utilization') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0.0
              max_value: 1.0
              severity: warn

      - name: norm_revenue
        description: "{{ doc('normalized_revenue') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0.0
              max_value: 1.0
              severity: warn

      - name: norm_repeat
        description: "{{ doc('normalized_repeat_pct') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0.0
              max_value: 1.0
              severity: warn

      - name: norm_confirmed
        description: "{{ doc('normalized_confirmed_pct') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0.0
              max_value: 1.0
              severity: warn

      - name: success_score
        description: "{{ doc('success_score') }}"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0.0
              max_value: 1.0
              severity: warn

      - name: last_updated_at
        description: "{{ doc('last_updated_at') }}"
        tests:
          - not_null:
              severity: warn